#include<stdio.h>
#include<stdlib.h>


double** sig2mat(double sigIn[][2048], int sigrow, int sigcol){
    int matrow = 128, matcol = 128;
    int x = 0, y = 0;
    int i, j;

    //double mat[matrow][matcol];

    double **mat = (double**)malloc(matrow*(sizeof(double*)));

    for (i = 0; i < matrow; i++)
    {
        *(mat+i) = (double*)malloc(sizeof(double)*matcol);
    }


    for(i=0;i<sigrow;i++) {
        for(j=0;j<sigcol;j++){
            mat[x][y++] = sigIn[i][j];

            if(y>=128){
                y = 0;
                x = x+1;
            }
        }
    }

    //tes print matrix 128
    // for(i=0;i<matrow;i++){
    //     for(j=0;j<matcol;j++){
    //         printf("%f\t",mat[i][j]);
    //     }
    //     printf("\n");
    // }

    return mat;
}

double** mat2sig(double **matIn, int matrow, int matcol, int framenum){
   int lcol = 0, rcol = 2048;
   int sigrow = 8, sigcol = 2048;
   int i,j;

   // tes print matrix 128
    for(i=0;i<matrow;i++){
        for(j=0;j<matcol;j++){
            printf("%f\t",matIn[i][j]);
        }
        printf("\n");
    }

   double **signalout =(double**)malloc(sigrow*(sizeof(double*)));

   for (i = 0; i < sigrow; i++)
    {
        *(signalout+i) = (double*)malloc(sizeof(double)*sigcol);
    }

   //iterasi all input matrix
   int row = 0;
   int col = lcol;

   for (i = 0; i < matrow; i++)
   {
        for (j = 0; i < matcol; j++)
        {
            signalout[row][col++] = matIn[i][j];
        }
        if (col > rcol)
        {
            col = lcol;
            row++;
        }
        if (row == 8)
        {
            lcol = rcol;
            rcol += 2048;
        }
   }

   return signalout;
}

int main(void) {
    int i,j;
    int sigrow = 8, sigcol = 2048;
    int matrow = 128, matcol = 128;
    //double signal[] = {6.444,6.448,6.448,6.431,6.467,6.523,6.529,6.546,6.565,6.533,6.471,6.461,6.5,6.448,6.415,6.438,6.461,6.52,6.578,6.565,6.539,6.507,6.484,6.461,6.422,6.402,6.376,6.386,6.376,6.333,6.314,6.327,6.35,6.382,6.369,6.395,6.392,6.35,6.356,6.408,6.454,6.487,6.51,6.539,6.52,6.493,6.477,6.454,6.451,6.458,6.503,6.513,6.477,6.428,6.399,6.379,6.356,6.356,6.333,6.284,6.294,6.333,6.307,6.258,6.216,6.232,6.242,6.222,6.203,6.183,6.176,6.173,6.157,6.127,6.101,6.052,6.056,6.108,6.17,6.212,6.248,6.278,6.288,6.301,6.304,6.281,6.225,6.245,6.265,6.291,6.317,6.314,6.304,6.281,6.248,6.229,6.196,6.167,6.141,6.137,6.154,6.19,6.19,6.18,6.17,6.15,6.098,6.092,6.062,6.049,6.062,6.15,6.275,6.493,6.791,7.052,7.222,7.239,7.131,6.85,6.467,6.297,6.258,6.235,6.239,6.239,6.239,6.222,6.19,6.183,6.186,6.19,6.209,6.239,6.248,6.222,6.19,6.209,6.248,6.235,6.225,6.229,6.248,6.255,6.229,6.255,6.281,6.261,6.281,6.284,6.278,6.271,6.281,6.291,6.294,6.294,6.301,6.327,6.346,6.343,6.327,6.333,6.337,6.337,6.343,6.34,6.33,6.366,6.386,6.418,6.441,6.454,6.444,6.451,6.422,6.399,6.392,6.402,6.408,6.392,6.369,6.363,6.363,6.35,6.337,6.33,6.324,6.317,6.307,6.275,6.245,6.242,6.278,6.294,6.307,6.32,6.333,6.307,6.301,6.317,6.337,6.35,6.35,6.33,6.317,6.317,6.32,6.327,6.34,6.346,6.353,6.356,6.366,6.382,6.386,6.363,6.366,6.382,6.425,6.451,6.461,6.454,6.444,6.458,6.477,6.5,6.51,6.503,6.487,6.477,6.487,6.49,6.477,6.471,6.471,6.458,6.477,6.516,6.526,6.529,6.52,6.513,6.529,6.552,6.559,6.556,6.542,6.516,6.507,6.487,6.48,6.51,6.533,6.542,6.523,6.497,6.51,6.49,6.441,6.389,6.408,6.448,6.461,6.441,6.415,6.386,6.399,6.382,6.314,6.261,6.258,6.252,6.248,6.304,6.431,6.585,6.85,7.088,7.261,7.343,7.304,7.121,6.725,6.467,6.412,6.402,6.392,6.333,6.301,6.327,6.34,6.343,6.356,6.376,6.369,6.369,6.369,6.369,6.376,6.369,6.363,6.33,6.32,6.379,6.412,6.441,6.461,6.471,6.428,6.412,6.412,6.408,6.412,6.415,6.395,6.363,6.353,6.366,6.422,6.471,6.5,6.546,6.575,6.611,6.68,6.686,6.693,6.69,6.686,6.673,6.67,6.69,6.729,6.732,6.709,6.683,6.65,6.627,6.634,6.598,6.565,6.533,6.49,6.435,6.389,6.376,6.346,6.317,6.284,6.252,6.232,6.258,6.271,6.268,6.252,6.206,6.19,6.167,6.134,6.098,6.111,6.183,6.19,6.199,6.209,6.219,6.209,6.235,6.242,6.255,6.258,6.268,6.301,6.284,6.242,6.248,6.278,6.275,6.271,6.284,6.324,6.33,6.284,6.248,6.258,6.248,6.248,6.258,6.261,6.271,6.271,6.284,6.268,6.255,6.242,6.248,6.232,6.239,6.275,6.317,6.356,6.346,6.337,6.35,6.35,6.359,6.379,6.405,6.422,6.422,6.435,6.438,6.428,6.418,6.386,6.389,6.415,6.389,6.389,6.402,6.359,6.337,6.33,6.359,6.356,6.353,6.327,6.35,6.343,6.317,6.31,6.32,6.32,6.281,6.229,6.176,6.173,6.183,6.203,6.281,6.451,6.693,6.964,7.154,7.265,7.31,7.255,6.876,6.454,6.343,6.343,6.34,6.297,6.284,6.294,6.297,6.294,6.291,6.297,6.297,6.294,6.307,6.31,6.297,6.307,6.337,6.346,6.363,6.386,6.363,6.356,6.356,6.386,6.395,6.395,6.386,6.382,6.389,6.395,6.382,6.373,6.382,6.399,6.412,6.425,6.422,6.412,6.425,6.438,6.441,6.438,6.435,6.454,6.448,6.435,6.451,6.487,6.529,6.549,6.542,6.559,6.552,6.542,6.516,6.5,6.51,6.526,6.507,6.467,6.451,6.418,6.415,6.431,6.444,6.428,6.415,6.412,6.412,6.392,6.386,6.399,6.405,6.412,6.431,6.444,6.428,6.431,6.448,6.451,6.435,6.448,6.441,6.435,6.444,6.428,6.438,6.49,6.493,6.461,6.454,6.464,6.461,6.395,6.382,6.431,6.467,6.474,6.497,6.497,6.471,6.477,6.5,6.503,6.49,6.484,6.448,6.448,6.425,6.389,6.382,6.422,6.474,6.497,6.536,6.562,6.546,6.526,6.467,6.428,6.431,6.438,6.477,6.536,6.556,6.552,6.562,6.523,6.516,6.487,6.461,6.441,6.428,6.428,6.428,6.415,6.428,6.418,6.376,6.346,6.324,6.33,6.363,6.392,6.425,6.461,6.484,6.51,6.487,6.405,6.366,6.35,6.324,6.366,6.48,6.634,6.912,7.203,7.392,7.5,7.487,7.32,6.843,6.461,6.353,6.288,6.255,6.255,6.242,6.232,6.212,6.183,6.167,6.206,6.222,6.219,6.216,6.19,6.167,6.131,6.121,6.111,6.121,6.114,6.108,6.095,6.098,6.098,6.157,6.222,6.255,6.265,6.248,6.235,6.235,6.245,6.252,6.248,6.248,6.239,6.232,6.225,6.245,6.265,6.294,6.314,6.333,6.337,6.32,6.288,6.297,6.317,6.337,6.382,6.405,6.379,6.343,6.337,6.359,6.392,6.395,6.422,6.415,6.386,6.392,6.405,6.389,6.379,6.353,6.33,6.346,6.363,6.366,6.356,6.343,6.327,6.324,6.324,6.291,6.281,6.271,6.271,6.314,6.33,6.333,6.34,6.33,6.32,6.359,6.389,6.51,6.627,6.641,6.608,6.454,6.232,6.036,5.784,5.444,5.307,5.32,5.373,5.474,5.65,5.915,6.127,6.248,6.346,6.402,6.389,6.369,6.327,6.294,6.297,6.301,6.314,6.359,6.399,6.415,6.435,6.415,6.415,6.454,6.49,6.503,6.513,6.52,6.565,6.559,6.539,6.569,6.592,6.611,6.641,6.657,6.676,6.693,6.703,6.712,6.725,6.755,6.817,6.85,6.892,6.925,6.915,6.922,6.977,7.036,7.042,7.059,7.069,7.059,7.046,7.029,7,6.954,6.876,6.827,6.81,6.778,6.732,6.69,6.657,6.631,6.614,6.592,6.565,6.539,6.526,6.533,6.542,6.539,6.546,6.572,6.552,6.539,6.539,6.529,6.516,6.513,6.51,6.487,6.487,6.503,6.516,6.48,6.48,6.474,6.474,6.477,6.484,6.454,6.435,6.435,6.412,6.356,6.392,6.418,6.386,6.363,6.346,6.366,6.399,6.392,6.382,6.382,6.389,6.402,6.422,6.395,6.379,6.379,6.379,6.359,6.327,6.304,6.346,6.382,6.392,6.438,6.412,6.382,6.408,6.415,6.444,6.464,6.451,6.428,6.395,6.363,6.366,6.33,6.356,6.373,6.392,6.405,6.405,6.402,6.359,6.376,6.418,6.408,6.379,6.346,6.373,6.392,6.402,6.382,6.376,6.386,6.395,6.415,6.458,6.507,6.562,6.605,6.598,6.588,6.582,6.542,6.497,6.471,6.458,6.441,6.422,6.425,6.408,6.418,6.408,6.402,6.405,6.366,6.353,6.33,6.297,6.284,6.275,6.265,6.255,6.261,6.271,6.258,6.258,6.242,6.216,6.212,6.199,6.176,6.147,6.16,6.163,6.183,6.199,6.203,6.225,6.245,6.252,6.261,6.327,6.337,6.359,6.35,6.284,6.239,6.239,6.255,6.261,6.284,6.301,6.284,6.294,6.278,6.18,6.154,6.176,6.154,6.163,6.18,6.163,6.15,6.157,6.163,6.15,6.114,6.065,6.049,6.082,6.18,6.304,6.503,6.807,7.098,7.245,7.291,7.255,6.99,6.536,6.333,6.33,6.294,6.281,6.34,6.359,6.359,6.35,6.343,6.333,6.31,6.297,6.288,6.294,6.281,6.281,6.281,6.291,6.291,6.271,6.265,6.268,6.265,6.268,6.271,6.242,6.225,6.261,6.278,6.294,6.314,6.301,6.294,6.304,6.297,6.307,6.317,6.31,6.317,6.31,6.31,6.32,6.324,6.33,6.324,6.35,6.363,6.359,6.366,6.382,6.379,6.366,6.366,6.359,6.343,6.359,6.376,6.389,6.402,6.422,6.415,6.379,6.382,6.412,6.412,6.422,6.408,6.389,6.386,6.376,6.356,6.356,6.366,6.35,6.35,6.366,6.343};

    double signal[sigrow][sigcol];

    //generate sinyal
    for (i = 0; i < sigrow; i++)
    {
        for (j = 0; j < sigcol; j++)
        {
            signal[i][j] = j;
        }
    }

    //tes print signal generate
    // for (i = 0; i < sigrow; i++)
    // {
    //     for (j = 0; j < sigcol; j++)
    //     {
    //         printf("%f\t", signal[i][j]);
    //     }
    //     printf("\n");
    // }

    //matrix conversion
    double** matrix = sig2mat(signal, sigrow, sigcol);

    //signal conversion
    double** sinyal = mat2sig(matrix, matrow, matcol, 1);

    //tes print matrix
    // for(i=0;i<128;i++){
    //     for(j=0;j<128;j++){
    //         printf("%f\t",matrix[i][j]);
    //     }
    //     printf("\n");
    // }

    //tes print sinyal
    // for(i=0;i<sigrow;i++){
    //     for(j=0;j<sigcol;j++){
    //         printf("%f\t",sinyal[i][j]);
    //     }
    //     printf("\n");
    // }



    return 0;
}


